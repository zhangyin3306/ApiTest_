{"name": "test_run_excel_case[Case1]", "status": "broken", "statusDetails": {"message": "KeyError: 0", "trace": "self = <case.test_excel_case.TestExcel_case object at 0x0000022AACFFF5B0>\nCase = {'cookies': '', 'headers': '{\\n           \"Authorization\" : \"Bearer eyJhbGciOiJIUzUxMiJ9.eyJsb2dpbl91c2VyX2tleSI6IjEwM...wzCQcmHSe10K4c0wd1GO-OWCOvWjsZbsMIFRHmtj8wIXyxoYlVyHS9Cnk9-A\"\\n        }', 'status_code': 200.0, '前置条件': 'word_1', ...}\n\n    @pytest.mark.parametrize(\"Case\",run_list)\n    def test_run_excel_case(self,Case):\n        url = ConfigYaml().config[\"url\"]+Case[ConfigYaml().config[\"excel\"][\"url\"]]\n        case_id=Case[ConfigYaml().config[\"excel\"][\"case_id\"]]\n        case_model=Case[ConfigYaml().config[\"excel\"][\"case_model\"]]\n        case_name=Case[ConfigYaml().config[\"excel\"][\"case_name\"]]\n        pre_exec=Case[ConfigYaml().config[\"excel\"][\"pre_exec\"]]\n        method=Case[ConfigYaml().config[\"excel\"][\"method\"]]\n        params_type=Case[ConfigYaml().config[\"excel\"][\"params_type\"]]\n        params=Case[ConfigYaml().config[\"excel\"][\"params\"]]\n        expect_result=Case[ConfigYaml().config[\"excel\"][\"expect_result\"]]\n        actual_result=Case[ConfigYaml().config[\"excel\"][\"actual_result\"]]\n        is_run=Case[ConfigYaml().config[\"excel\"][\"is_run\"]]\n        headers=Case[ConfigYaml().config[\"excel\"][\"headers\"]]\n        cookies= Case[ConfigYaml().config[\"excel\"][\"cookies\"]]\n        code=Case[ConfigYaml().config[\"excel\"][\"code\"]]\n        db_verify=Case[ConfigYaml().config[\"excel\"][\"db_verify\"]]\n    \n    \n    \n        # # print(url,headers,params)\n        # print(type(headers))\n        # # 如果你想打印 headers 的内容来验证它是否正确设置\n        # for key, value in headers.items():\n        #     print(f\"{key}: {value}\")\n    \n    \n    \n        if  len(str(params).strip()) != 0:\n            params  = json.loads(params)\n        if  len(str(headers).strip()) != 0:\n            headers  = json.loads(headers)\n    \n        # 验证前置条件,找到前置条件用例\n        if pre_exec:\n            pass\n            pre_case  = get_case_pre(pre_exec)\n            print(f\"前置条件信息为{pre_exec}\")\n            per_res =  self.run_pre(pre_case)\n>           headers,cookies = self.get_correlation(headers,cookies,per_res)\n\ntest_excel_case.py:87: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <case.test_excel_case.TestExcel_case object at 0x0000022AACFFF5B0>\nheaders = {'Authorization': 'Bearer eyJhbGciOiJIUzUxMiJ9.eyJsb2dpbl91c2VyX2tleSI6IjEwMDAwLTI0ODY1ODNhLWIyYzctNGEyMC05MzhlLTYzN2Q5NjY4OWJiNiJ9.NyqolDnLEBaujfEsRGvHgQSBqhwzCQcmHSe10K4c0wd1GO-OWCOvWjsZbsMIFRHmtj8wIXyxoYlVyHS9Cnk9-A'}\ncookie = ''\npre_res = {'body': {'code': '40000', 'message': '请求访问：/charging-maintenance-server/maintenance/orderNo，认证失败，无法访问系统资源', 'success': False}, 'code': 200}\n\n    def get_correlation(self,headers,cookie,pre_res):\n        \"\"\"\n        验证结果是否有关联\n        如果有关联,执行前置用例获取结果\n        再替换结果\n        :return:\n        \"\"\"\n        headers_para,cookie_para  = Base.params_find(headers,cookie)\n        if len(headers_para):\n>           headers_data = pre_res[\"body\"][headers_para[0]]\nE           KeyError: 0\n\ntest_excel_case.py:102: KeyError"}, "attachments": [{"name": "log", "source": "bbd16286-d475-4393-8375-a9a31ff02514-attachment.txt", "type": "text/plain"}], "parameters": [{"name": "Case", "value": "{'用例ID': 'word_1', '模块': '运维工单', '接口名称': '创建工单', '请求URL': '/maintenance/orderNo', '前置条件': 'word_1', '请求类型': 'get', '请求参数类型': 'json', '请求参数': '{\\n            \"orderTypeId\":\"453622917134237696\"\\n        }', '预期结果': '', '实际结果': '', '备注': '', '是否运行': 'Y', 'headers': '{\\n           \"Authorization\" : \"Bearer eyJhbGciOiJIUzUxMiJ9.eyJsb2dpbl91c2VyX2tleSI6IjEwMDAwLTI0ODY1ODNhLWIyYzctNGEyMC05MzhlLTYzN2Q5NjY4OWJiNiJ9.NyqolDnLEBaujfEsRGvHgQSBqhwzCQcmHSe10K4c0wd1GO-OWCOvWjsZbsMIFRHmtj8wIXyxoYlVyHS9Cnk9-A\"\\n        }', 'cookies': '', 'status_code': 200.0, '数据库验证': ''}"}], "start": 1726254470230, "stop": 1726254470422, "uuid": "5687d3f9-6efd-4fd8-b6d4-cc3e2c77c412", "historyId": "0ac6740dfdee71c07e5ee869cd73da7c", "testCaseId": "74ece03cc882bdf5889680a5566d1d10", "fullName": "case.test_excel_case.TestExcel_case#test_run_excel_case", "labels": [{"name": "parentSuite", "value": "case"}, {"name": "suite", "value": "test_excel_case"}, {"name": "subSuite", "value": "TestExcel_case"}, {"name": "host", "value": "张引电脑"}, {"name": "thread", "value": "20088-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "case.test_excel_case"}]}